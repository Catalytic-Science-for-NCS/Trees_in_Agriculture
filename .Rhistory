#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15)+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))));c_ha
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15)+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8),range=c(0.5, 5), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))));c_ha
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15)+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))));c_ha
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15)+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(range=c(0,5), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))));c_ha
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15)+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))));c_ha
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15)+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))),
labels=c("0-2","2-4","4-6","6-8"));c_ha
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15)+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))),
breaks=c(0.006,2,4,6,8),
labels=c("0-2","2-4","4-6","6-8", "8+"));c_ha
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15)+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))),
breaks=c(2,4,6,8),
labels=c("0-2","2-4","4-6","6-8"));c_ha
ggsave("C:/Users/vgriffey/OneDrive - Conservation International Foundation/VivianAnalyses/Draft Figures/draft_main_figure_simplified_fluxandtotalLabels.png",
c_ha, width=8, height=4, bg='white')
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography,color=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15)+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))),
breaks=c(2, 4, 6, 8),
labels=c("0-2","2-4","4-6","6-8"));c_ha
ggsave("C:/Users/vgriffey/OneDrive - Conservation International Foundation/VivianAnalyses/Draft Figures/draft_main_figure_simplified_fluxandtotalLabels.png",
c_ha, width=8, height=4, bg='white')
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography,color=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15,
color="grey40")+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))),
breaks=c(2, 4, 6, 8),
labels=c("0-2","2-4","4-6","6-8"));c_ha
ggsave("C:/Users/vgriffey/OneDrive - Conservation International Foundation/VivianAnalyses/Draft Figures/draft_main_figure_simplified_fluxandtotalLabels.png",
c_ha, width=8, height=4, bg='white')
ggsave("C:/Users/vgriffey/OneDrive - Conservation International Foundation/VivianAnalyses/Draft Figures/draft_main_figure_simplified_fluxandtotalLabels_noColor.png",
c_ha, width=8, height=4, bg='white')
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15,
color="grey40")+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))),
breaks=c(2, 4, 6, 8),
labels=c("0-2","2-4","4-6","6-8"));c_ha
ggsave("C:/Users/vgriffey/OneDrive - Conservation International Foundation/VivianAnalyses/Draft Figures/draft_main_figure_simplified_fluxandtotalLabels_noColor.png",
c_ha, width=8, height=4, bg='white')
c_ha <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=AgArea_ha, y=Delta, fill=Geography, size=Flux_density*(44/12)))+
geom_point(shape=21, color='grey40')+
facet_grid(~Ag.Type)+
# ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$flux_rank=="Global Top 5",],
#                          inherit.aes = F,
#                          aes(x=AgArea_ha, y=Delta, label=NAME),
#                          size=2,
#                          nudge_y = 0.5,
#                          segment.size  = 0.2,
#                          min.segment.length = 0,
#                          box.padding = 0.15,
#                          label.padding = 0.15)+
ggrepel::geom_label_repel(data=long_updated[!is.na(long_updated$AgArea_ha) & long_updated$total_MgC_rank=="Global Top 5",],
inherit.aes = F,
aes(x=AgArea_ha, y=Delta, label=NAME),
size=2,
nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0,
box.padding = 0.15,
label.padding = 0.15,
color="grey40")+ #adds label of top 5 potential
labs(x="Log Area (ha)", y="Mean Additional Tree Cover Potential (%)")+
scale_x_continuous(trans = "log10",
labels = trans_format("log10", math_format(10^.x)))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_size(limits=c(0.006,8), name=expression(atop(Mean~Flux~Density,
(Mg~CO[2]~Ha^{-1}~Yr^{-1}))),
breaks=c(2, 4, 6, 8),
labels=c("0-2","2-4","4-6","6-8"));c_ha
ggsave("C:/Users/vgriffey/OneDrive - Conservation International Foundation/VivianAnalyses/Draft Figures/draft_main_figure_simplified_fluxandtotalLabels_noColor.png",
c_ha, width=8, height=4, bg='white')
ggsave("C:/Users/vgriffey/OneDrive - Conservation International Foundation/VivianAnalyses/Draft Figures/draft_main_figure_simplified_fluxandtotalLabels.png",
c_ha, width=8, height=4, bg='white')
## new figure (figure 9)
fig9 <- ggplot(data=long_updated[!is.na(long_updated$AgArea_ha),],
aes(x=Total_MgC/30/1e+9*(44/12), y=Flux_density*(44/12), fill=lat, color=lat))+
geom_point(shape=21)+
facet_grid(~Ag.Type)+
ggrepel::geom_label_repel(inherit.aes = F,
aes(x=Total_MgC/30/1e+9*(44/12), y=Flux_density*(44/12), label=NAME),
size=1.8,
# nudge_y = 0.5,
segment.size  = 0.2,
min.segment.length = 0.3,
box.padding = 0.15,
label.padding = 0.15,
max.overlaps = 5,
color="grey40")+
labs(x=expression(Total~Annual~Potential~(Pg~CO[2]~Yr^{-1})), y=expression(Mean~Flux~Density~(Mg~CO[2]~Ha^{-1}~Yr^{-1})))+
theme(strip.placement = "outside",
panel.spacing = unit(1, "lines"),
legend.spacing.y = unit(0.75, 'cm'))+
scale_fill_discrete(name="Geography")+
scale_colour_discrete(name="Geography");fig9
library(tidyverse)
setwd("C:/Users/vgriffey/OneDrive - Conservation International Foundation/Documents/GitHub/Trees_in_Agriculture/")
# ------------------------------------------------------------------------
# ------------------------------------------------------------------------
#results by biome then reformatted to long for ggplot
df <- read.csv("data/06_21_2023/biome_results_06212023.csv")
df_long <- reshape2::melt(df, id.vars=c("BIOME_NUM","BIOME_NAME"), measure.vars=c("Crop_TotalC_sum_MgC_30yr", "Graze_TotalC_sum_MgC_30yr"))
names(df_long) <- c("BIOME_NUM","BIOME_NAME","variable","value")
#cleaning up lots of names and abbreviations
df_long <- df_long %>% mutate(biome_abbrev = case_when(
BIOME_NAME == "Mediterranean Forests, Woodlands & Scrub" ~"MF" ,
BIOME_NAME == "Temperate Broadleaf & Mixed Forests" ~"TeBMF" ,
BIOME_NAME ==  "Temperate Grasslands, Savannas & Shrublands" ~ "TeGSS",
BIOME_NAME == "Tropical & Subtropical Dry Broadleaf Forests" ~ "TrSDBF",
BIOME_NAME == "Tropical & Subtropical Grasslands, Savannas & Shrublands" ~ "TrSGSS",
BIOME_NAME ==  "Tropical & Subtropical Moist Broadleaf Forests" ~ "TrSMBF",
BIOME_NAME ==  "Deserts & Xeric Shrublands" ~ "DXS",
BIOME_NAME ==  "Montane Grasslands & Shrublands" ~ "MGSS",
BIOME_NAME ==  "Temperate Conifer Forests" ~ "TeCF",
BIOME_NAME ==  "Tropical & Subtropical Coniferous Forest" ~ "TrSCF",
BIOME_NAME ==  "Tropical & Subtropical Grasslands, Savannas, and Shrublands" ~ "TrSGSS"
))
df_long$biome_abbrev <- factor(df_long$biome_abbrev, levels=c("DXS","MF","MGSS","TeGSS","TeCF","TeBMF","TrSGSS","TrSDBF","TrSMBF"))
df_long <- df_long %>% mutate(climate=case_when(biome_abbrev=="DXS" ~ "Desert",
biome_abbrev=="MF" ~ "Mediterranean",
biome_abbrev=="MGSS" ~ "Montane",
biome_abbrev=="TeBMF"~"Temperate",
biome_abbrev=="TeGSS"~"Temperate",
biome_abbrev=="TeCF" ~ "Temperate",
biome_abbrev=="TrSDBF" ~ "Tropical/Subtropical",
biome_abbrev=="TrSGSS" ~ "Tropical/Subtropical",
biome_abbrev=="TrSMBF" ~ "Tropical/Subtropical"))
df_long <- df_long %>% mutate(forested=case_when(biome_abbrev=="MGSS" ~ "Forest",
biome_abbrev=="TeBMF"~"Forest",
biome_abbrev=="TeCF" ~ "Forest",
biome_abbrev=="TrSDBF" ~ "Forest",
biome_abbrev=="TrSMBF" ~ "Forest"))
#remove tropical coniferous forests
df_long <- subset(df_long, biome_abbrev!="TeCF")
#conversiont to Pg of CO2
df_long$value <- df_long$value/1000000000*(44/12)
#write.csv(df_long, "C:/Users/vgriffey/OneDrive - Conservation International Foundation/VivianAnalyses/figure6_outputData.csv")
theme = theme_set(theme_minimal())
ggplot(df_long, aes(x=biome_abbrev, y=value, fill=variable))+
geom_bar(stat="identity", color="black",
position="stack") +
ggforce::facet_row(~climate, strip.position = "bottom", scales = "free_x",  space="free") +
theme(axis.text.x = element_text(angle=45, hjust=1),
legend.title=element_blank(),
panel.grid.major.x=element_blank(),
axis.text.y = element_text(colour="grey20"),
axis.ticks.y= element_line(colour="grey20"),,
axis.ticks.x=element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.background=element_rect(color="grey20"))+
scale_y_continuous(expand = c(0, 0), limits=c(0,40))+
labs(x="Biome", y=expression(Total~Annual~Mitigation~Potential~(Pg~CO[2]~30~Yr^{-1})))+#parse(text=paste0("Pg", " ~CO[2]", " ~30Yr^-1")))+
scale_fill_manual(values=c("#CEAB07", "#798E87"), labels=c("Crop","Graze"))
ggplot(df_long, aes(x=biome_abbrev, y=value, fill=variable))+
geom_bar(stat="identity", color="black",
position="stack") +
ggforce::facet_row(~climate, strip.position = "bottom", scales = "free_x",  space="free") +
theme(axis.text.x = element_text(angle=45, hjust=1),
legend.title=element_blank(),
panel.grid.major.x=element_blank(),
axis.text.y = element_text(colour="grey20"),
axis.ticks.y= element_line(colour="grey20"),,
axis.ticks.x=element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.background=element_rect(color="grey20"))+
scale_y_continuous(expand = c(0, 0), limits=c(0,40))+
labs(x="Biome", y=expression(Total~Annual~Mitigation~Potential~/n(Pg~CO[2]~30~Yr^{-1})))+#parse(text=paste0("Pg", " ~CO[2]", " ~30Yr^-1")))+
ggplot(df_long, aes(x=biome_abbrev, y=value, fill=variable))+
geom_bar(stat="identity", color="black",
position="stack") +
ggforce::facet_row(~climate, strip.position = "bottom", scales = "free_x",  space="free") +
theme(axis.text.x = element_text(angle=45, hjust=1),
legend.title=element_blank(),
panel.grid.major.x=element_blank(),
axis.text.y = element_text(colour="grey20"),
axis.ticks.y= element_line(colour="grey20"),,
axis.ticks.x=element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.background=element_rect(color="grey20"))+
scale_y_continuous(expand = c(0, 0), limits=c(0,40))+
labs(x="Biome", y=expression(atop(Total~Annual~Mitigation~Potential,
(Pg~CO[2]~30~Yr^{-1}))))+#parse(text=paste0("Pg", " ~CO[2]", " ~30Yr^-1")))+
scale_fill_manual(values=c("#CEAB07", "#798E87"), labels=c("Crop","Graze"))
ggsave("../../../VivianAnalyses/Draft Figures/totalPotential_biome_barplot.png",width=8.5, height=7, dpi=600, bg="white")
ggplot(df_long, aes(x=biome_abbrev, y=value, fill=variable))+
geom_bar(stat="identity", color="black",
position="stack") +
ggforce::facet_row(~climate, strip.position = "bottom", scales = "free_x",  space="free") +
theme(axis.text.x = element_text(angle=45, hjust=1),
legend.title=element_blank(),
panel.grid.major.x=element_blank(),
axis.text.y = element_text(colour="grey20"),
axis.ticks.y= element_line(colour="grey20"),,
axis.ticks.x=element_blank(),
panel.background = element_blank(),
strip.placement = "outside",
strip.background=element_rect(color="grey20"))+
scale_y_continuous(expand = c(0, 0), limits=c(0,40))+
labs(x="Biome", y=expression(atop(Total~Additional~Mitigation~Potential,
(Pg~CO[2]~30~Yr^{-1}))))+#parse(text=paste0("Pg", " ~CO[2]", " ~30Yr^-1")))+
scale_fill_manual(values=c("#CEAB07", "#798E87"), labels=c("Crop","Graze"))
ggsave("../../../VivianAnalyses/Draft Figures/totalPotential_biome_barplot.png",width=8.5, height=7, dpi=600, bg="white")
